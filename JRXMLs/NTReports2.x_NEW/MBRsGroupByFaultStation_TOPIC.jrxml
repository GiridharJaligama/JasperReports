<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 7.1.0.final using JasperReports Library version 6.4.3  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="MBRsGroupByFaultStation_TOPIC" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="6cce743f-d7b1-4aae-9ecb-87b32ea03d6b">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="TESTING"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="240"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="751"/>
	<parameter name="IncidentStatus" class="java.util.List"/>
	<parameter name="ItemType" class="java.util.List"/>
	<parameter name="CompanyID" class="java.util.List"/>
	<parameter name="sdate" class="net.sf.jasperreports.types.date.DateRange"/>
	<parameter name="edate" class="net.sf.jasperreports.types.date.DateRange"/>
	<parameter name="AssignedStation" class="java.util.List"/>
	<parameter name="FaultStation" class="java.util.List"/>
	<parameter name="LossCode" class="java.util.List"/>
	<parameter name="FaultAirline" class="java.util.List"/>
	<queryString language="SQL">
		<![CDATA[select       
	   incident.stationassigned_ID,         
       s1.stationcode as ascode,      
	   faultstation_ID,
       s2.stationcode as fscode, 
       s2.station_id as fsid, 
       s2.companycode_ID as fccode, 
       incident.ID AS ID,
       incident.incident_id as IncidentID,
       incident.itemType_ID,
       incident.loss_code,
       incident.createdate,
	   status.status_ID as stdesc,
	   status.description as Status,
	   itemtype.description as itdesc, 
	   GROUP_CONCAT(DISTINCT (CONCAT_WS(' ',p.firstname,p.lastname ))) FIRSTNAME,
	   GROUP_CONCAT(DISTINCT (CONCAT_WS(' ' ,it.legfrom,IT.FLIGHTNUM))) itinerary,
	   SUBSTRING_INDEX(GROUP_CONCAT(CAST(it.legto AS CHAR) ORDER BY (IT.ORDER_ID) DESC), ',', 1) AS  LEGTO,
	   agent.username as agentusername,
       incident.status_ID
from        
	  station s1,   
      station s2,   
      status, 
	  itemtype,
	  agent, 
	  incident 
	  left outer join passenger p on p.incident_ID = incident.ID       
	  left outer join itinerary it on it.incident_ID = incident.ID and 
      it.itinerarytype = 0     
where     
	   s1.station_ID = incident.stationassigned_ID and        
	   s2.station_ID = incident.faultstation_ID  and 
	   status.status_ID = incident.status_ID and      
       agent.Agent_ID = incident.agent_ID and       
	   itemtype.ItemType_ID = incident.itemType_ID           
       and $X{IN, incident.status_ID, IncidentStatus}
		and $X{IN, incident.itemtype_id,ItemType}
		and $X{IN, s1.companycode_ID,CompanyID}
		and $X{BETWEEN, incident.createdate, sdate,edate}
		and $X{IN, incident.stationassigned_ID,AssignedStation}
		and $X{IN, incident.faultstation_ID ,FaultStation}
		and $X{IN, incident.loss_code, LossCode}    
		and $X{IN, s2.companycode_ID, FaultAirline}                
GROUP BY  fsid,incident.itemtype_ID,incident.ID,it.itinerary_ID]]>
	</queryString>
	<field name="stationassigned_ID" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="stationassigned_ID"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="incident"/>
	</field>
	<field name="ascode" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="ascode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="station"/>
	</field>
	<field name="faultstation_ID" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="faultstation_ID"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="incident"/>
	</field>
	<field name="fscode" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="fscode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="station"/>
	</field>
	<field name="fsid" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="fsid"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="station"/>
	</field>
	<field name="fccode" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="fccode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="station"/>
	</field>
	<field name="ID" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="ID"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="incident"/>
	</field>
	<field name="IncidentID" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="IncidentID"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="incident"/>
	</field>
	<field name="itemType_ID" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="itemType_ID"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="incident"/>
	</field>
	<field name="loss_code" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="loss_code"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="incident"/>
	</field>
	<field name="createdate" class="java.sql.Timestamp">
		<property name="com.jaspersoft.studio.field.label" value="createdate"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="incident"/>
	</field>
	<field name="stdesc" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="stdesc"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="status"/>
	</field>
	<field name="Status" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="Status"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="status"/>
	</field>
	<field name="itdesc" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="itdesc"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="itemtype"/>
	</field>
	<field name="FIRSTNAME" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="FIRSTNAME"/>
	</field>
	<field name="itinerary" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="itinerary"/>
	</field>
	<field name="LEGTO" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="LEGTO"/>
	</field>
	<field name="agentusername" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="agentusername"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="agent"/>
	</field>
	<field name="status_ID" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="status_ID"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="incident"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="79" splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="35" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="61" splitType="Stretch">
			<staticText>
				<reportElement x="133" y="0" width="100" height="30" uuid="b0cc790e-193b-4809-999d-f065915aae01">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b0293af5-56bf-4680-8e1e-d6bd52a7b08e"/>
				</reportElement>
				<text><![CDATA[faultstation_ID]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="125" splitType="Stretch">
			<textField>
				<reportElement x="133" y="17" width="100" height="30" uuid="60721e09-5f8d-423e-bf83-c234ac629197">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b0293af5-56bf-4680-8e1e-d6bd52a7b08e"/>
				</reportElement>
				<textFieldExpression><![CDATA[$F{faultstation_ID}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
